'use strict';

function simpleCounter() {
  var currentCount = 1;

  return function () {
    return currentCount++;
  };
}
var counter = simpleCounter();
counter(); //1
counter(); //2

/*Задача 1: улучшить счетчик
  getNext() — получить следующее значение, то,
  что раньше делал вызов counter().
  set(value) — поставить значение.
  reset() — обнулить счётчик.
*/

function improvedCounter() {
  var currentCount = 1;

  // вернем объект и добавим к нему методы
  return {
    getNext: function getNext() {
      return ++currentCount;
    },
    set: function set(val) {
      return currentCount = val;
    },
    reset: function reset() {
      return currentCount = 1;
    }
  };
}

var i1 = improvedCounter();
var i2 = improvedCounter();

i1.getNext(); //1
i1.set(5); //5
i1.reset(); //1
i1.getNext(); //2
i1.getNext(); //3

i2.getNext(); //1
i2.set(5); //5
i2.reset(); //1
i2.getNext(); //2

/*Задача 2: вернуть возможность прямого вызова функции
который увеличивает счетчик*/

function simpleCounterWithMethods() {
  var currentCount = 1;

  //объявим функцию вместо объекта
  function counter() {
    return currentCount++;
  }

  //и добавим к ней методы!
  counter.getNext = function () {
    return ++currentCount;
  }, counter.set = function (val) {
    return currentCount = val;
  }, counter.reset = function () {
    return currentCount = 1;
  };

  return counter;
}

var s1 = simpleCounterWithMethods();

s1(); //1;
s1(); //2;
s1.reset(); //1;

/*Задача 3: (правильно)
Напишите функцию sum, которая работает так: sum(a)(b) = a+b.*/

function sum(a) {
  return function (b) {
    return a + b;
  };
}

sum(5)(6);

/*Задача 4: (правильно)
Задача — реализовать строковый буфер на функциях в JavaScript,
со следующим синтаксисом:

Создание объекта: var buffer = makeBuffer();.

Вызов makeBuffer должен возвращать такую функцию buffer,
которая при вызове buffer(value) добавляет значение в некоторое
внутреннее хранилище,
а при вызове без аргументов buffer() — возвращает его.

*/

function makeBuffer() {
  var buffer = "";

  return function (value) {
    if (value) {
      buffer += value;
    } else {
      return buffer;
    }
  };
}

var b = makeBuffer();

b(); //''
b('a'); //'a'
b('bc'); //'abc'
b(); //'abc'

var b1 = makeBuffer();

b1('test');
b1('rest');
b1(); //'testrest'

/*Задача 5: добавить в makeBuffer метод clear
Решение: правильно, но лучше использовать
Function Declaration instead of Function Expression
*/

function makeBuffer() {
  var buffer = "";

  function buffFn(value) {
    if (value) {
      buffer += value;
    } else {
      return buffer;
    }
  }

  buffFn.clear = function () {
    buffer = "";
  };

  return buffFn;
}

var b = makeBuffer();

b(); //''
b('a');
b('bc');
b(); //'abc'
b.clear();
b(); // ''

var b1 = makeBuffer();

b1('test');
b1('rest');
b1(); //'testrest'
b1.clear();
b1('test');
b1(); // 'test'

/*Задача 6 (правильно)*/

var users = [{
  name: "Вася",
  surname: 'Иванов',
  age: 20
}, {
  name: "Петя",
  surname: 'Чапаев',
  age: 25
}, {
  name: "Маша",
  surname: 'Медведева',
  age: 18
}];

function byField(field) {
  return function (a, b) {
    return a[field] > b[field] ? 1 : -1;
  };
}
/*
Напишите функцию byField(field),
которую можно использовать в sort для сравнения объектов по полю field,
чтобы пример ниже заработал.
*/

users.sort(byField('name'));
users.forEach(function (user) {
  console.log(user.name);
}); // Вася, Маша, Петя

users.sort(byField('age'));
users.forEach(function (user) {
  console.log(user.name);
}); // Маша, Вася, Петя

/*Задача 7:

Создайте функцию filter(arr, func), которая получает массив arr и возвращает новый,
в который входят только те элементы arr, для которых func возвращает true.

Создайте набор «готовых фильтров»: inBetween(a,b) — «между a,b», inArray([...]) — «в массиве [...]».
Использование должно быть таким:
filter(arr, inBetween(3,6)) — выберет только числа от 3 до 6,
filter(arr, inArray([1,2,3])) — выберет только элементы, совпадающие с одним из значений массива.*/

function filter(arr, func) {
  return arr.filter(func);
}

/*Incorrect way: cant access to array current item.*/

// function inBetween(a,b) {
//   return item >= a && item <= b ? true : false;
// }

// function inArray(arr) {
//   return item in arr ? true : false;
// }

/*To properly create filter functions, think about it as a arr.filter callback, it provides an argumens*/

function inBetween(a, b) {
  return function (item) {
    return item >= a && item <= b;
  };
}
function inArray(arr) {
  return function (item) {
    return item in arr;
  };
}

var a = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];

console.log(filter(a, function (a) {
  return a % 2 === 0;
})); // 2,4,6

console.log(filter(a, inBetween(3, 8)));
console.log(filter(a, inArray([2, 4, 6])));

/*Задача 8: замыкание для цикла*/
function makeArmy() {

  var shooters = [];

  for (var i = 0; i < 10; i++) {
    var shooter = function shooter() {
      var count = i; //2
      return function () {
        //1
        console.log(count);
      };
    };
    shooters.push(shooter()); //3
  }

  return shooters;
}

var army = makeArmy();

army[0](); // стрелок выводит 10, а должен 0
army[5](); // стрелок выводит 10...
// .. все стрелки выводят 10 вместо 0,1,2...9

/*Решение: (правильно) 
Почему выводит 10? Потому что функция-стрелок запускается в момент когда цикл уже отработал, 
переменная i в LE этой функции будет равна последнему значению цикла, т.е. 10

1. Пусть функция-стрелок возвращает функцию
2. В замыкании сохраним текущее значение i в новую переменную. Внутренняя функция получит к ней доступ.
3. Функцию-стрелок необходимо запустить (что вернет функцию, которая потом будет запущенна в army[0]())
*/
//# sourceMappingURL=data:application/json;base64,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QUksSUFBSSxHQUFHLFFBQVEsRUFBRSxDQUFDOztBQUV0QixJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUU7QUFBQyxBQUNWLElBQUksQ0FBQyxDQUFDLENBQUMsRUFBRTs7Ozs7Ozs7Ozs7QUFBQyIsImZpbGUiOiJwYXJ0MS9jbG9qdXJlcy8wMy5jbG9qdXJlX3Rhc2tzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gc2ltcGxlQ291bnRlcigpIHtcbiAgdmFyIGN1cnJlbnRDb3VudCA9IDE7XG5cbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjdXJyZW50Q291bnQrKztcbiAgfTtcbn1cbnZhciBjb3VudGVyID0gc2ltcGxlQ291bnRlcigpO1xuY291bnRlcigpOyAvLzFcbmNvdW50ZXIoKTsgLy8yXG5cblxuLyrQl9Cw0LTQsNGH0LAgMTog0YPQu9GD0YfRiNC40YLRjCDRgdGH0LXRgtGH0LjQulxuICBnZXROZXh0KCkg4oCUINC/0L7Qu9GD0YfQuNGC0Ywg0YHQu9C10LTRg9GO0YnQtdC1INC30L3QsNGH0LXQvdC40LUsINGC0L4sXG4gINGH0YLQviDRgNCw0L3RjNGI0LUg0LTQtdC70LDQuyDQstGL0LfQvtCyIGNvdW50ZXIoKS5cbiAgc2V0KHZhbHVlKSDigJQg0L/QvtGB0YLQsNCy0LjRgtGMINC30L3QsNGH0LXQvdC40LUuXG4gIHJlc2V0KCkg4oCUINC+0LHQvdGD0LvQuNGC0Ywg0YHRh9GR0YLRh9C40LouXG4qL1xuXG5mdW5jdGlvbiBpbXByb3ZlZENvdW50ZXIoKXtcbiAgdmFyIGN1cnJlbnRDb3VudCA9IDE7XG5cbiAgLy8g0LLQtdGA0L3QtdC8INC+0LHRitC10LrRgiDQuCDQtNC+0LHQsNCy0LjQvCDQuiDQvdC10LzRgyDQvNC10YLQvtC00YtcbiAgcmV0dXJuIHtcbiAgICBnZXROZXh0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gKytjdXJyZW50Q291bnQ7XG4gICAgfSxcbiAgICBzZXQ6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgcmV0dXJuIGN1cnJlbnRDb3VudCA9IHZhbDtcbiAgICB9LFxuICAgIHJlc2V0OiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gY3VycmVudENvdW50ID0gMTtcbiAgICB9XG4gIH1cbn1cblxudmFyIGkxID0gaW1wcm92ZWRDb3VudGVyKCk7XG52YXIgaTIgPSBpbXByb3ZlZENvdW50ZXIoKTtcblxuaTEuZ2V0TmV4dCgpIC8vMVxuaTEuc2V0KDUpICAgIC8vNVxuaTEucmVzZXQoKSAgIC8vMVxuaTEuZ2V0TmV4dCgpIC8vMlxuaTEuZ2V0TmV4dCgpIC8vM1xuXG5pMi5nZXROZXh0KCkgLy8xXG5pMi5zZXQoNSkgICAgLy81XG5pMi5yZXNldCgpICAgLy8xXG5pMi5nZXROZXh0KCkgLy8yXG5cblxuLyrQl9Cw0LTQsNGH0LAgMjog0LLQtdGA0L3Rg9GC0Ywg0LLQvtC30LzQvtC20L3QvtGB0YLRjCDQv9GA0Y/QvNC+0LPQviDQstGL0LfQvtCy0LAg0YTRg9C90LrRhtC40LhcbtC60L7RgtC+0YDRi9C5INGD0LLQtdC70LjRh9C40LLQsNC10YIg0YHRh9C10YLRh9C40LoqL1xuXG5mdW5jdGlvbiBzaW1wbGVDb3VudGVyV2l0aE1ldGhvZHMoKXtcbiAgdmFyIGN1cnJlbnRDb3VudCA9IDE7XG5cbiAgLy/QvtCx0YrRj9Cy0LjQvCDRhNGD0L3QutGG0LjRjiDQstC80LXRgdGC0L4g0L7QsdGK0LXQutGC0LBcbiAgZnVuY3Rpb24gY291bnRlcigpe1xuICAgIHJldHVybiBjdXJyZW50Q291bnQrKztcbiAgfVxuXG4gIC8v0Lgg0LTQvtCx0LDQstC40Lwg0Log0L3QtdC5INC80LXRgtC+0LTRiyFcbiAgY291bnRlci5nZXROZXh0ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiArK2N1cnJlbnRDb3VudDtcbiAgfSxcbiAgY291bnRlci5zZXQgPSBmdW5jdGlvbih2YWwpIHtcbiAgICByZXR1cm4gY3VycmVudENvdW50ID0gdmFsO1xuICB9LFxuICBjb3VudGVyLnJlc2V0ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBjdXJyZW50Q291bnQgPSAxO1xuICB9XG5cbiAgcmV0dXJuIGNvdW50ZXI7XG59XG5cblxudmFyIHMxID0gc2ltcGxlQ291bnRlcldpdGhNZXRob2RzKCk7XG5cbnMxKCk7IC8vMTtcbnMxKCk7IC8vMjtcbnMxLnJlc2V0KCk7IC8vMTtcblxuXG5cblxuLyrQl9Cw0LTQsNGH0LAgMzogKNC/0YDQsNCy0LjQu9GM0L3QvilcbtCd0LDQv9C40YjQuNGC0LUg0YTRg9C90LrRhtC40Y4gc3VtLCDQutC+0YLQvtGA0LDRjyDRgNCw0LHQvtGC0LDQtdGCINGC0LDQujogc3VtKGEpKGIpID0gYStiLiovXG5cbmZ1bmN0aW9uIHN1bSAoYSkge1xuICByZXR1cm4gZnVuY3Rpb24oYikge1xuICAgIHJldHVybiBhICsgYjtcbiAgfVxufVxuXG5zdW0oNSkoNik7XG5cblxuXG5cbi8q0JfQsNC00LDRh9CwIDQ6ICjQv9GA0LDQstC40LvRjNC90L4pXG7Ql9Cw0LTQsNGH0LAg4oCUINGA0LXQsNC70LjQt9C+0LLQsNGC0Ywg0YHRgtGA0L7QutC+0LLRi9C5INCx0YPRhNC10YAg0L3QsCDRhNGD0L3QutGG0LjRj9GFINCyIEphdmFTY3JpcHQsXG7RgdC+INGB0LvQtdC00YPRjtGJ0LjQvCDRgdC40L3RgtCw0LrRgdC40YHQvtC8OlxuXG7QodC+0LfQtNCw0L3QuNC1INC+0LHRitC10LrRgtCwOiB2YXIgYnVmZmVyID0gbWFrZUJ1ZmZlcigpOy5cblxu0JLRi9C30L7QsiBtYWtlQnVmZmVyINC00L7Qu9C20LXQvSDQstC+0LfQstGA0LDRidCw0YLRjCDRgtCw0LrRg9GOINGE0YPQvdC60YbQuNGOIGJ1ZmZlcixcbtC60L7RgtC+0YDQsNGPINC/0YDQuCDQstGL0LfQvtCy0LUgYnVmZmVyKHZhbHVlKSDQtNC+0LHQsNCy0LvRj9C10YIg0LfQvdCw0YfQtdC90LjQtSDQsiDQvdC10LrQvtGC0L7RgNC+0LVcbtCy0L3Rg9GC0YDQtdC90L3QtdC1INGF0YDQsNC90LjQu9C40YnQtSxcbtCwINC/0YDQuCDQstGL0LfQvtCy0LUg0LHQtdC3INCw0YDQs9GD0LzQtdC90YLQvtCyIGJ1ZmZlcigpIOKAlCDQstC+0LfQstGA0LDRidCw0LXRgiDQtdCz0L4uXG5cbiovXG5cbmZ1bmN0aW9uIG1ha2VCdWZmZXIgKCkge1xuICB2YXIgYnVmZmVyID0gXCJcIjtcblxuICByZXR1cm4gZnVuY3Rpb24odmFsdWUpIHtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIGJ1ZmZlciArPSB2YWx1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGJ1ZmZlcjtcbiAgICB9XG4gIH1cbn1cblxudmFyIGIgPSBtYWtlQnVmZmVyKCk7XG5cbmIoKSAvLycnXG5iKCdhJykgLy8nYSdcbmIoJ2JjJykgLy8nYWJjJ1xuYigpIC8vJ2FiYydcblxudmFyIGIxID0gbWFrZUJ1ZmZlcigpXG5cbmIxKCd0ZXN0JylcbmIxKCdyZXN0JylcbmIxKCkgLy8ndGVzdHJlc3QnXG5cblxuXG4vKtCX0LDQtNCw0YfQsCA1OiDQtNC+0LHQsNCy0LjRgtGMINCyIG1ha2VCdWZmZXIg0LzQtdGC0L7QtCBjbGVhclxu0KDQtdGI0LXQvdC40LU6INC/0YDQsNCy0LjQu9GM0L3Qviwg0L3QviDQu9GD0YfRiNC1INC40YHQv9C+0LvRjNC30L7QstCw0YLRjFxuRnVuY3Rpb24gRGVjbGFyYXRpb24gaW5zdGVhZCBvZiBGdW5jdGlvbiBFeHByZXNzaW9uXG4qL1xuXG5cbmZ1bmN0aW9uIG1ha2VCdWZmZXIgKCkge1xuICB2YXIgYnVmZmVyID0gXCJcIjtcblxuICBmdW5jdGlvbiBidWZmRm4odmFsdWUpe1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgYnVmZmVyICs9IHZhbHVlO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gYnVmZmVyO1xuICAgIH1cbiAgfVxuXG4gIGJ1ZmZGbi5jbGVhciA9IGZ1bmN0aW9uKCl7XG4gICAgYnVmZmVyID0gXCJcIjtcbiAgfVxuXG4gIHJldHVybiBidWZmRm47XG59XG5cbnZhciBiID0gbWFrZUJ1ZmZlcigpO1xuXG5iKCkgLy8nJ1xuYignYScpXG5iKCdiYycpXG5iKCkgLy8nYWJjJ1xuYi5jbGVhcigpO1xuYigpIC8vICcnXG5cbnZhciBiMSA9IG1ha2VCdWZmZXIoKVxuXG5iMSgndGVzdCcpXG5iMSgncmVzdCcpXG5iMSgpIC8vJ3Rlc3RyZXN0J1xuYjEuY2xlYXIoKVxuYjEoJ3Rlc3QnKVxuYjEoKSAvLyAndGVzdCdcblxuXG5cblxuXG5cblxuLyrQl9Cw0LTQsNGH0LAgNiAo0L/RgNCw0LLQuNC70YzQvdC+KSovXG5cbnZhciB1c2VycyA9IFt7XG4gIG5hbWU6IFwi0JLQsNGB0Y9cIixcbiAgc3VybmFtZTogJ9CY0LLQsNC90L7QsicsXG4gIGFnZTogMjBcbn0sIHtcbiAgbmFtZTogXCLQn9C10YLRj1wiLFxuICBzdXJuYW1lOiAn0KfQsNC/0LDQtdCyJyxcbiAgYWdlOiAyNVxufSwge1xuICBuYW1lOiBcItCc0LDRiNCwXCIsXG4gIHN1cm5hbWU6ICfQnNC10LTQstC10LTQtdCy0LAnLFxuICBhZ2U6IDE4XG59XTtcblxuXG5mdW5jdGlvbiBieUZpZWxkKGZpZWxkKSB7XG4gIHJldHVybiBmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBhW2ZpZWxkXSA+IGJbZmllbGRdID8gMSA6IC0xO1xuICB9XG59XG4vKlxu0J3QsNC/0LjRiNC40YLQtSDRhNGD0L3QutGG0LjRjiBieUZpZWxkKGZpZWxkKSxcbtC60L7RgtC+0YDRg9GOINC80L7QttC90L4g0LjRgdC/0L7Qu9GM0LfQvtCy0LDRgtGMINCyIHNvcnQg0LTQu9GPINGB0YDQsNCy0L3QtdC90LjRjyDQvtCx0YrQtdC60YLQvtCyINC/0L4g0L/QvtC70Y4gZmllbGQsXG7Rh9GC0L7QsdGLINC/0YDQuNC80LXRgCDQvdC40LbQtSDQt9Cw0YDQsNCx0L7RgtCw0LsuXG4qL1xuXG5cbnVzZXJzLnNvcnQoYnlGaWVsZCgnbmFtZScpKTtcbnVzZXJzLmZvckVhY2goZnVuY3Rpb24odXNlcikge1xuICBjb25zb2xlLmxvZyh1c2VyLm5hbWUpO1xufSk7IC8vINCS0LDRgdGPLCDQnNCw0YjQsCwg0J/QtdGC0Y9cblxudXNlcnMuc29ydChieUZpZWxkKCdhZ2UnKSk7XG51c2Vycy5mb3JFYWNoKGZ1bmN0aW9uKHVzZXIpIHtcbiAgY29uc29sZS5sb2codXNlci5uYW1lKTtcbn0pOyAvLyDQnNCw0YjQsCwg0JLQsNGB0Y8sINCf0LXRgtGPXG5cblxuXG4vKtCX0LDQtNCw0YfQsCA3OlxuXG7QodC+0LfQtNCw0LnRgtC1INGE0YPQvdC60YbQuNGOIGZpbHRlcihhcnIsIGZ1bmMpLCDQutC+0YLQvtGA0LDRjyDQv9C+0LvRg9GH0LDQtdGCINC80LDRgdGB0LjQsiBhcnIg0Lgg0LLQvtC30LLRgNCw0YnQsNC10YIg0L3QvtCy0YvQuSxcbtCyINC60L7RgtC+0YDRi9C5INCy0YXQvtC00Y/RgiDRgtC+0LvRjNC60L4g0YLQtSDRjdC70LXQvNC10L3RgtGLIGFyciwg0LTQu9GPINC60L7RgtC+0YDRi9GFIGZ1bmMg0LLQvtC30LLRgNCw0YnQsNC10YIgdHJ1ZS5cblxu0KHQvtC30LTQsNC50YLQtSDQvdCw0LHQvtGAIMKr0LPQvtGC0L7QstGL0YUg0YTQuNC70YzRgtGA0L7QssK7OiBpbkJldHdlZW4oYSxiKSDigJQgwqvQvNC10LbQtNGDIGEsYsK7LCBpbkFycmF5KFsuLi5dKSDigJQgwqvQsiDQvNCw0YHRgdC40LLQtSBbLi4uXcK7Llxu0JjRgdC/0L7Qu9GM0LfQvtCy0LDQvdC40LUg0LTQvtC70LbQvdC+INCx0YvRgtGMINGC0LDQutC40Lw6XG5maWx0ZXIoYXJyLCBpbkJldHdlZW4oMyw2KSkg4oCUINCy0YvQsdC10YDQtdGCINGC0L7Qu9GM0LrQviDRh9C40YHQu9CwINC+0YIgMyDQtNC+IDYsXG5maWx0ZXIoYXJyLCBpbkFycmF5KFsxLDIsM10pKSDigJQg0LLRi9Cx0LXRgNC10YIg0YLQvtC70YzQutC+INGN0LvQtdC80LXQvdGC0YssINGB0L7QstC/0LDQtNCw0Y7RidC40LUg0YEg0L7QtNC90LjQvCDQuNC3INC30L3QsNGH0LXQvdC40Lkg0LzQsNGB0YHQuNCy0LAuKi9cblxuZnVuY3Rpb24gZmlsdGVyKGFyciwgZnVuYyl7XG4gIHJldHVybiBhcnIuZmlsdGVyKGZ1bmMpO1xufVxuXG4vKkluY29ycmVjdCB3YXk6IGNhbnQgYWNjZXNzIHRvIGFycmF5IGN1cnJlbnQgaXRlbS4qL1xuXG4vLyBmdW5jdGlvbiBpbkJldHdlZW4oYSxiKSB7XG4vLyAgIHJldHVybiBpdGVtID49IGEgJiYgaXRlbSA8PSBiID8gdHJ1ZSA6IGZhbHNlO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBpbkFycmF5KGFycikge1xuLy8gICByZXR1cm4gaXRlbSBpbiBhcnIgPyB0cnVlIDogZmFsc2U7XG4vLyB9XG5cblxuLypUbyBwcm9wZXJseSBjcmVhdGUgZmlsdGVyIGZ1bmN0aW9ucywgdGhpbmsgYWJvdXQgaXQgYXMgYSBhcnIuZmlsdGVyIGNhbGxiYWNrLCBpdCBwcm92aWRlcyBhbiBhcmd1bWVucyovXG5cblxuZnVuY3Rpb24gaW5CZXR3ZWVuKGEsYikge1xuICByZXR1cm4gaXRlbSA9PiBpdGVtID49IGEgJiYgaXRlbSA8PSBiXG59XG5mdW5jdGlvbiBpbkFycmF5KGFycikge1xuICByZXR1cm4gaXRlbSA9PiBpdGVtIGluIGFycjtcbn1cblxuXG5cbnZhciBhID0gWzEsMiwzLDQsNSw2LDcsOCw5LDEwXTtcblxuY29uc29sZS5sb2coZmlsdGVyKGEsIGZ1bmN0aW9uKGEpIHtcbiAgcmV0dXJuIGEgJSAyID09PSAwO1xufSkpOyAvLyAyLDQsNlxuXG5jb25zb2xlLmxvZyggZmlsdGVyKGEsIGluQmV0d2VlbigzLCA4KSkgKTtcbmNvbnNvbGUubG9nKCBmaWx0ZXIoYSwgaW5BcnJheShbMiw0LDZdKSkgKTtcblxuXG5cbi8q0JfQsNC00LDRh9CwIDg6INC30LDQvNGL0LrQsNC90LjQtSDQtNC70Y8g0YbQuNC60LvQsCovXG5mdW5jdGlvbiBtYWtlQXJteSgpIHtcblxuICB2YXIgc2hvb3RlcnMgPSBbXTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICB2YXIgc2hvb3RlciA9IGZ1bmN0aW9uKCkgeyBcbiAgICAgIHZhciBjb3VudCA9IGk7IC8vMlxuICAgICAgcmV0dXJuIGZ1bmN0aW9uKCl7IC8vMVxuICAgICAgICBjb25zb2xlLmxvZyhjb3VudCk7XG4gICAgICB9XG4gICAgfTtcbiAgICBzaG9vdGVycy5wdXNoKHNob290ZXIoKSk7IC8vM1xuICB9XG5cbiAgcmV0dXJuIHNob290ZXJzO1xufVxuXG52YXIgYXJteSA9IG1ha2VBcm15KCk7XG5cbmFybXlbMF0oKTsgLy8g0YHRgtGA0LXQu9C+0Log0LLRi9Cy0L7QtNC40YIgMTAsINCwINC00L7Qu9C20LXQvSAwXG5hcm15WzVdKCk7IC8vINGB0YLRgNC10LvQvtC6INCy0YvQstC+0LTQuNGCIDEwLi4uXG4vLyAuLiDQstGB0LUg0YHRgtGA0LXQu9C60Lgg0LLRi9Cy0L7QtNGP0YIgMTAg0LLQvNC10YHRgtC+IDAsMSwyLi4uOVxuXG5cblxuLyrQoNC10YjQtdC90LjQtTogKNC/0YDQsNCy0LjQu9GM0L3QvikgXG7Qn9C+0YfQtdC80YMg0LLRi9Cy0L7QtNC40YIgMTA/INCf0L7RgtC+0LzRgyDRh9GC0L4g0YTRg9C90LrRhtC40Y8t0YHRgtGA0LXQu9C+0Log0LfQsNC/0YPRgdC60LDQtdGC0YHRjyDQsiDQvNC+0LzQtdC90YIg0LrQvtCz0LTQsCDRhtC40LrQuyDRg9C20LUg0L7RgtGA0LDQsdC+0YLQsNC7LCBcbtC/0LXRgNC10LzQtdC90L3QsNGPIGkg0LIgTEUg0Y3RgtC+0Lkg0YTRg9C90LrRhtC40Lgg0LHRg9C00LXRgiDRgNCw0LLQvdCwINC/0L7RgdC70LXQtNC90LXQvNGDINC30L3QsNGH0LXQvdC40Y4g0YbQuNC60LvQsCwg0YIu0LUuIDEwXG5cbjEuINCf0YPRgdGC0Ywg0YTRg9C90LrRhtC40Y8t0YHRgtGA0LXQu9C+0Log0LLQvtC30LLRgNCw0YnQsNC10YIg0YTRg9C90LrRhtC40Y5cbjIuINCSINC30LDQvNGL0LrQsNC90LjQuCDRgdC+0YXRgNCw0L3QuNC8INGC0LXQutGD0YnQtdC1INC30L3QsNGH0LXQvdC40LUgaSDQsiDQvdC+0LLRg9GOINC/0LXRgNC10LzQtdC90L3Rg9GOLiDQktC90YPRgtGA0LXQvdC90Y/RjyDRhNGD0L3QutGG0LjRjyDQv9C+0LvRg9GH0LjRgiDQuiDQvdC10Lkg0LTQvtGB0YLRg9C/LlxuMy4g0KTRg9C90LrRhtC40Y4t0YHRgtGA0LXQu9C+0Log0L3QtdC+0LHRhdC+0LTQuNC80L4g0LfQsNC/0YPRgdGC0LjRgtGMICjRh9GC0L4g0LLQtdGA0L3QtdGCINGE0YPQvdC60YbQuNGOLCDQutC+0YLQvtGA0LDRjyDQv9C+0YLQvtC8INCx0YPQtNC10YIg0LfQsNC/0YPRidC10L3QvdCwINCyIGFybXlbMF0oKSlcbiovXG5cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
