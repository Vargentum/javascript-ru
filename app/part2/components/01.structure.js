'use strict';

/*

Widget: 
  
  - object that controls excisting DOM, or create its own one
  - only ONE element inside Widget Constructor
  - no ID inside markup
  - Delegation for handlers
  
  - Handlers call following methods, avoid `hard` logic in handlers
    - better readability
    - possibility to add public methods
  
  - Lazy DOM generation:
    - render if really need
    - increase performance at `Init loading stage`

    example: don't render Dropdown inside Menu, do it when user try to open it!


  - separate Public & Private methods

*/

function example1() {

  function Menu(options) {

    var elem = null;

    function getElem() {
      if (!elem) render();
      return elem;
    }

    function render() {
      elem = document.createElement('div');
      elem.classList.add('menu');
      document.body.appendChild(elem);

      var title = document.createElement('span');
      title.classList.add('menu-title');
      title.textContent = options.title;
      elem.appendChild(title);

      elem.addEventListener('click', function (e) {
        if (!event.target.closest('.menu-title')) return;
        toggle();
      });
    }

    function renderItems() {
      var list = document.createElement('ul');
      list.classList.add('menu-list');
      options.items.forEach(function (item) {
        var li = document.createElement('li');
        li.textContent = item;
        list.appendChild(li);
      });
      elem.appendChild(list);
    }

    function open() {
      var list = elem.querySelector('ul');
      if (!list) renderItems();
      elem.classList.add('is-open');
    }

    function close() {
      elem.classList.remove('is-open');
    }

    function toggle() {
      if (elem.classList.contains('is-open')) close();else open();
    }

    this.open = open;
    this.close = close;
    this.toggle = toggle;
    this.getElem = getElem;
  }

  // создать объект меню с данным заголовком и опциями
  var menu = new Menu({
    title: "Сладости",
    items: ["Торт", "Пончик", "Пирожное", "Шоколадка", "Мороженое"]
  });

  // получить сгенерированный DOM-элемент меню
  var elem = menu.getElem();

  // вставить меню в нужное место страницы
  document.body.appendChild(elem);
}
// example1()

/* Task 1

Создайте компонент «Часы» (Clock).
Интерфейс:

var clock = new Clock({
  elem: элемент
});

clock.start(); // старт
clock.stop(); // стоп
Остальные методы, если нужны, должны быть приватными.

При нажатии на alert часы должны приостанавливаться, а затем продолжать идти с правильным временем.
*/

function task1() {

  function Clock(options) {
    var elem = options.elem;
    var timerId = null;
    var stringifyTime = function stringifyTime(time) {
      return time < 10 ? '0' + time : time;
    };

    function createSgmt(type) {
      var sgmt = document.createElement('span');
      sgmt.classList.add('clock-' + type);
      elem.appendChild(sgmt);
      return sgmt;
    }

    function update(date) {
      var dateTpl = [{
        name: 'hour',
        time: date.getHours()
      }, {
        name: 'minute',
        time: date.getMinutes()
      }, {
        name: 'second',
        time: date.getSeconds()
      }];

      dateTpl.forEach(function (tpl) {
        var name = tpl.name;
        var time = tpl.time;

        var sgmt = elem.querySelector('.clock-' + name);

        if (!sgmt) sgmt = createSgmt(name);
        sgmt.textContent = stringifyTime(time);
      });
    }

    function start() {
      timerId = setTimeout(function () {
        update(new Date());
        start();
      }, 100);
    }

    function stop() {
      if (timerId) clearTimeout(timerId);
    }

    this.start = start;
    this.stop = stop;
  }

  var clock = new Clock({
    elem: document.getElementById('clock')
  });
  clock.start();

  var start = document.getElementById('clock-start');
  start.onclick = clock.start;

  var stop = document.getElementById('clock-stop');
  stop.onclick = clock.stop;
}
task1();
//# sourceMappingURL=data:application/json;base64,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ZSI6InBhcnQyL2NvbXBvbmVudHMvMDEuc3RydWN0dXJlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcblxuV2lkZ2V0OiBcbiAgXG4gIC0gb2JqZWN0IHRoYXQgY29udHJvbHMgZXhjaXN0aW5nIERPTSwgb3IgY3JlYXRlIGl0cyBvd24gb25lXG4gIC0gb25seSBPTkUgZWxlbWVudCBpbnNpZGUgV2lkZ2V0IENvbnN0cnVjdG9yXG4gIC0gbm8gSUQgaW5zaWRlIG1hcmt1cFxuICAtIERlbGVnYXRpb24gZm9yIGhhbmRsZXJzXG4gIFxuICAtIEhhbmRsZXJzIGNhbGwgZm9sbG93aW5nIG1ldGhvZHMsIGF2b2lkIGBoYXJkYCBsb2dpYyBpbiBoYW5kbGVyc1xuICAgIC0gYmV0dGVyIHJlYWRhYmlsaXR5XG4gICAgLSBwb3NzaWJpbGl0eSB0byBhZGQgcHVibGljIG1ldGhvZHNcbiAgXG4gIC0gTGF6eSBET00gZ2VuZXJhdGlvbjpcbiAgICAtIHJlbmRlciBpZiByZWFsbHkgbmVlZFxuICAgIC0gaW5jcmVhc2UgcGVyZm9ybWFuY2UgYXQgYEluaXQgbG9hZGluZyBzdGFnZWBcblxuICAgIGV4YW1wbGU6IGRvbid0IHJlbmRlciBEcm9wZG93biBpbnNpZGUgTWVudSwgZG8gaXQgd2hlbiB1c2VyIHRyeSB0byBvcGVuIGl0IVxuXG5cbiAgLSBzZXBhcmF0ZSBQdWJsaWMgJiBQcml2YXRlIG1ldGhvZHNcblxuKi9cblxuZnVuY3Rpb24gZXhhbXBsZTEgKCkge1xuICBcbiAgZnVuY3Rpb24gTWVudSAob3B0aW9ucykge1xuICAgIFxuICAgIGxldCBlbGVtID0gbnVsbDtcblxuICAgIGZ1bmN0aW9uIGdldEVsZW0oKSB7XG4gICAgICBpZiAoIWVsZW0pIHJlbmRlcigpXG4gICAgICByZXR1cm4gZWxlbVxuICAgIH1cblxuXG4gICAgZnVuY3Rpb24gcmVuZGVyKCkge1xuICAgICAgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoJ21lbnUnKVxuICAgICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtKVxuXG4gICAgICBsZXQgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICAgIHRpdGxlLmNsYXNzTGlzdC5hZGQoJ21lbnUtdGl0bGUnKVxuICAgICAgdGl0bGUudGV4dENvbnRlbnQgPSBvcHRpb25zLnRpdGxlXG4gICAgICBlbGVtLmFwcGVuZENoaWxkKHRpdGxlKVxuXG5cbiAgICAgIGVsZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZSkgPT4ge1xuICAgICAgICBpZiAoIWV2ZW50LnRhcmdldC5jbG9zZXN0KCcubWVudS10aXRsZScpKSByZXR1cm5cbiAgICAgICAgdG9nZ2xlKClcbiAgICAgIH0pXG4gICAgfVxuXG5cbiAgICBmdW5jdGlvbiByZW5kZXJJdGVtcygpIHtcbiAgICAgIGxldCBsaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKVxuICAgICAgbGlzdC5jbGFzc0xpc3QuYWRkKCdtZW51LWxpc3QnKVxuICAgICAgb3B0aW9ucy5pdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xuICAgICAgICBsZXQgbGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdsaScpXG4gICAgICAgIGxpLnRleHRDb250ZW50ID0gaXRlbVxuICAgICAgICBsaXN0LmFwcGVuZENoaWxkKGxpKVxuICAgICAgfSlcbiAgICAgIGVsZW0uYXBwZW5kQ2hpbGQobGlzdClcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIG9wZW4oKSB7XG4gICAgICBsZXQgbGlzdCA9IGVsZW0ucXVlcnlTZWxlY3RvcigndWwnKVxuICAgICAgaWYgKCFsaXN0KSByZW5kZXJJdGVtcygpXG4gICAgICBlbGVtLmNsYXNzTGlzdC5hZGQoJ2lzLW9wZW4nKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsb3NlKCkge1xuICAgICAgZWxlbS5jbGFzc0xpc3QucmVtb3ZlKCdpcy1vcGVuJylcbiAgICB9XG5cblxuICAgIGZ1bmN0aW9uIHRvZ2dsZSgpIHtcbiAgICAgIGlmIChlbGVtLmNsYXNzTGlzdC5jb250YWlucygnaXMtb3BlbicpKSBjbG9zZSgpXG4gICAgICBlbHNlIG9wZW4oKVxuICAgIH1cblxuXG4gICAgdGhpcy5vcGVuID0gb3BlblxuICAgIHRoaXMuY2xvc2UgPSBjbG9zZVxuICAgIHRoaXMudG9nZ2xlID0gdG9nZ2xlXG4gICAgdGhpcy5nZXRFbGVtID0gZ2V0RWxlbVxuICB9XG5cblxuXG5cbiAgLy8g0YHQvtC30LTQsNGC0Ywg0L7QsdGK0LXQutGCINC80LXQvdGOINGBINC00LDQvdC90YvQvCDQt9Cw0LPQvtC70L7QstC60L7QvCDQuCDQvtC/0YbQuNGP0LzQuFxuICBsZXQgbWVudSA9IG5ldyBNZW51KHtcbiAgICB0aXRsZTogXCLQodC70LDQtNC+0YHRgtC4XCIsXG4gICAgaXRlbXM6IFtcbiAgICAgIFwi0KLQvtGA0YJcIixcbiAgICAgIFwi0J/QvtC90YfQuNC6XCIsXG4gICAgICBcItCf0LjRgNC+0LbQvdC+0LVcIixcbiAgICAgIFwi0KjQvtC60L7Qu9Cw0LTQutCwXCIsXG4gICAgICBcItCc0L7RgNC+0LbQtdC90L7QtVwiXG4gICAgXVxuICB9KTtcblxuICAvLyDQv9C+0LvRg9GH0LjRgtGMINGB0LPQtdC90LXRgNC40YDQvtCy0LDQvdC90YvQuSBET00t0Y3Qu9C10LzQtdC90YIg0LzQtdC90Y5cbiAgbGV0IGVsZW0gPSBtZW51LmdldEVsZW0oKTtcblxuICAvLyDQstGB0YLQsNCy0LjRgtGMINC80LXQvdGOINCyINC90YPQttC90L7QtSDQvNC10YHRgtC+INGB0YLRgNCw0L3QuNGG0YtcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChlbGVtKTtcbn1cbi8vIGV4YW1wbGUxKClcblxuXG5cblxuXG5cblxuXG5cbi8qIFRhc2sgMVxuXG7QodC+0LfQtNCw0LnRgtC1INC60L7QvNC/0L7QvdC10L3RgiDCq9Cn0LDRgdGLwrsgKENsb2NrKS5cbtCY0L3RgtC10YDRhNC10LnRgTpcblxudmFyIGNsb2NrID0gbmV3IENsb2NrKHtcbiAgZWxlbTog0Y3Qu9C10LzQtdC90YJcbn0pO1xuXG5jbG9jay5zdGFydCgpOyAvLyDRgdGC0LDRgNGCXG5jbG9jay5zdG9wKCk7IC8vINGB0YLQvtC/XG7QntGB0YLQsNC70YzQvdGL0LUg0LzQtdGC0L7QtNGLLCDQtdGB0LvQuCDQvdGD0LbQvdGLLCDQtNC+0LvQttC90Ysg0LHRi9GC0Ywg0L/RgNC40LLQsNGC0L3Ri9C80LguXG5cbtCf0YDQuCDQvdCw0LbQsNGC0LjQuCDQvdCwIGFsZXJ0INGH0LDRgdGLINC00L7Qu9C20L3RiyDQv9GA0LjQvtGB0YLQsNC90LDQstC70LjQstCw0YLRjNGB0Y8sINCwINC30LDRgtC10Lwg0L/RgNC+0LTQvtC70LbQsNGC0Ywg0LjQtNGC0Lgg0YEg0L/RgNCw0LLQuNC70YzQvdGL0Lwg0LLRgNC10LzQtdC90LXQvC5cbiovXG5cblxuXG5mdW5jdGlvbiB0YXNrMSAoKSB7XG4gIFxuXG4gIGZ1bmN0aW9uIENsb2NrIChvcHRpb25zKSB7XG4gICAgbGV0IGVsZW0gPSBvcHRpb25zLmVsZW1cbiAgICBsZXQgdGltZXJJZCA9IG51bGxcbiAgICBsZXQgc3RyaW5naWZ5VGltZSA9IHRpbWUgPT4gdGltZSA8IDEwID8gYDAke3RpbWV9YCA6IHRpbWVcblxuICAgIGZ1bmN0aW9uIGNyZWF0ZVNnbXQodHlwZSkge1xuICAgICAgbGV0IHNnbXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJylcbiAgICAgIHNnbXQuY2xhc3NMaXN0LmFkZChgY2xvY2stJHt0eXBlfWApXG4gICAgICBlbGVtLmFwcGVuZENoaWxkKHNnbXQpXG4gICAgICByZXR1cm4gc2dtdFxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHVwZGF0ZShkYXRlKSB7XG4gICAgICBsZXQgZGF0ZVRwbCA9IFt7XG4gICAgICAgIG5hbWU6ICdob3VyJyxcbiAgICAgICAgdGltZTogZGF0ZS5nZXRIb3VycygpXG4gICAgICB9LHtcbiAgICAgICAgbmFtZTogJ21pbnV0ZScsXG4gICAgICAgIHRpbWU6IGRhdGUuZ2V0TWludXRlcygpXG4gICAgICB9LHtcbiAgICAgICAgbmFtZTogJ3NlY29uZCcsXG4gICAgICAgIHRpbWU6IGRhdGUuZ2V0U2Vjb25kcygpXG4gICAgICB9XVxuXG4gICAgICBkYXRlVHBsLmZvckVhY2godHBsID0+IHtcbiAgICAgICAgbGV0IHtuYW1lLCB0aW1lfSA9IHRwbFxuICAgICAgICBsZXQgc2dtdCA9IGVsZW0ucXVlcnlTZWxlY3RvcihgLmNsb2NrLSR7bmFtZX1gKVxuXG4gICAgICAgIGlmICghc2dtdCkgc2dtdCA9IGNyZWF0ZVNnbXQobmFtZSlcbiAgICAgICAgc2dtdC50ZXh0Q29udGVudCA9IHN0cmluZ2lmeVRpbWUodGltZSlcbiAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIGZ1bmN0aW9uIHN0YXJ0KCkge1xuICAgICAgdGltZXJJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICB1cGRhdGUobmV3IERhdGUoKSlcbiAgICAgICAgc3RhcnQoKVxuICAgICAgfSwgMTAwKVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHN0b3AoKSB7XG4gICAgICBpZiAodGltZXJJZCkgY2xlYXJUaW1lb3V0KHRpbWVySWQpXG4gICAgfSAgICBcblxuICAgIHRoaXMuc3RhcnQgPSBzdGFydFxuICAgIHRoaXMuc3RvcCA9IHN0b3BcbiAgfVxuXG5cblxuICBsZXQgY2xvY2sgPSBuZXcgQ2xvY2soe1xuICAgIGVsZW06IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9jaycpXG4gIH0pXG4gIGNsb2NrLnN0YXJ0KClcblxuXG4gIGxldCBzdGFydCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjbG9jay1zdGFydCcpXG4gIHN0YXJ0Lm9uY2xpY2sgPSBjbG9jay5zdGFydFxuXG4gIGxldCBzdG9wID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Nsb2NrLXN0b3AnKVxuICBzdG9wLm9uY2xpY2sgPSBjbG9jay5zdG9wXG5cbn1cbnRhc2sxKClcblxuXG5cblxuXG5cblxuXG5cblxuXG5cblxuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
