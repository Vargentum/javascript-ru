'use strict';

/*Coords relative to VISIBLE WINDOW
  similar to `position fixed`

  clientX, clientY

  elem.getBoundingClientRect()
  
    return object, containg 
      top
      left
      right
      bottom 
    coordinates of `elem`


  document.elemFromPoint(x, y)

    return element that holding x, y points
    how about two elements? if overlapping
*/

/*Coords relative to WHOLE PAGE
  similar to `position absolute in body`

  add position inside window to current scroll position

  pageX = clientX + pageXOffsest (or scrollLeft)
  pageY = clientY + pageYOffsest (or scrollTop)

*/

/* Task 1
find 
  outer top-left corner
  outer bottom-right corner
  inner top-left corner
  inner bottom-right corner
*/

function task1() {
  var field = document.getElementById('scrolled');
  var stringify = function stringify(x, y) {
    return x + ', ' + y;
  };
  var fieldRect = field.getBoundingClientRect();
  var getStyleVal = function getStyleVal(elem, prop) {
    return parseInt(getComputedStyle(field)[prop]);
  };

  var topLeftOuter = stringify(fieldRect.left, fieldRect.top);
  var bottomRightOuter = stringify(fieldRect.right, fieldRect.bottom);
  var topLeftInner = stringify(fieldRect.left + field.clientLeft, fieldRect.top + field.clientTop);
  var bottomRightInner = stringify(fieldRect.right - getStyleVal(field, 'borderRightWidth'), fieldRect.bottom - getStyleVal(field, 'borderBottomWidth'));

  console.log(topLeftOuter);
  console.log(topLeftInner);
  console.log(bottomRightOuter);
  console.log(bottomRightInner);
}
// task1()

/*Task 2

Создайте функцию positionAt(anchor, position, elem),
которая позиционирует элемент elem, в зависимости от position,
сверху ("top"), справа ("right") или снизу ("bottom") от элемента anchor.

Используйте её, чтобы сделать функцию showNote(anchor, position, html),
которая показывает элемент с классом note и текстом html
на позиции position рядом с элементом anchor.


Enlightment: 
  use TOP / LEFT properties when set up positioning of FIXED element
    and use top/left/right/bottom of `anchor` to get coords


*/

function task2() {
  var positionAt = function positionAt(anchor, position, elem) {
    elem.style.position = 'fixed';
    switch (position) {
      case 'top':
        elem.style.top = anchor.getBoundingClientRect().top - elem.offsetHeight + 'px';
        elem.style.left = anchor.getBoundingClientRect().left + 'px';
        break;
      case 'left':
        elem.style.left = anchor.getBoundingClientRect().left - elem.offsetWidth + 'px';
        elem.style.top = anchor.getBoundingClientRect().top + 'px';
        break;
      case 'bottom':
        elem.style.top = anchor.getBoundingClientRect().bottom + 'px';
        elem.style.left = anchor.getBoundingClientRect().left + 'px';
        break;
      case 'right':
        elem.style.left = anchor.getBoundingClientRect().right + 'px';
        elem.style.top = anchor.getBoundingClientRect().top + 'px';
        break;
    }
  };

  var showNote = function showNote(anchor, position, html) {
    var note = document.createElement('div');
    note.className = 'note';
    note.innerHTML = html;
    document.body.appendChild(note);
    positionAt(anchor, position, note);
  };

  ['top', 'right', 'bottom', 'left'].map(function (dir) {
    showNote(scrolled, dir, 'Hello note at ' + dir + ' !');
  });
}
// task2()

/*Task 3

Напишите функцию getDocumentScroll(), 
которая возвращает объект с информацией о текущей прокрутке и области видимости.

Свойства объекта-результата:
top — координата верхней границы видимой части (относительно документа).
bottom — координата нижней границы видимой части (относительно документа).
height — полная высота документа, включая прокрутку.

*/

function task3() {
  var getDocumentScroll = function getDocumentScroll() {
    var html = document.documentElement;
    var pageHeight = Math.max(document.body.scrollHeight, html.scrollHeight, document.body.offsetHeight, html.offsetHeight, document.body.clientHeight, html.clientHeight);
    debugger;
    return {
      top: pageYOffset,
      bottom: pageYOffset + html.clientHeight,
      height: height
    };
  };

  console.log(getDocumentScroll());
}
// task3()

/* Task4

Modify task2 function, to make tips scroll/resize agnostic
*/

function task21() {
  var positionAt = function positionAt(anchor, position, elem) {
    elem.style.position = 'absolute';

    var calcAbsPosOf = function calcAbsPosOf(val) {
      var offset = val === 'left' || val === 'right' ? pageXOffset : pageYOffset;
      return anchor.getBoundingClientRect()[val] + offset;
    };
    var getStyleVal = function getStyleVal(prop) {
      return parseInt(getComputedStyle(anchor)[prop]);
    };

    switch (position) {
      case 'top-out':
        elem.style.top = calcAbsPosOf('top') - elem.offsetHeight + 'px';
        elem.style.left = calcAbsPosOf('left') + 'px';
        break;
      case 'left-out':
        elem.style.left = calcAbsPosOf('left') - elem.offsetWidth + 'px';
        elem.style.top = calcAbsPosOf('top') + 'px';
        break;
      case 'bottom-out':
        elem.style.top = calcAbsPosOf('bottom') + 'px';
        elem.style.left = calcAbsPosOf('left') + 'px';
        break;
      case 'right-out':
        elem.style.left = calcAbsPosOf('right') + 'px';
        elem.style.top = calcAbsPosOf('top') + 'px';
        break;
      case 'top-in':
        elem.style.top = calcAbsPosOf('top') + getStyleVal('borderTopWidth') - elem.offsetHeight + 'px';
        elem.style.left = calcAbsPosOf('left') + getStyleVal('borderLeftWidth') + 'px';
        break;
      case 'left-in':
        elem.style.left = calcAbsPosOf('left') + getStyleVal('borderLeftWidth') - elem.offsetWidth + 'px';
        elem.style.top = calcAbsPosOf('top') + getStyleVal('borderTopWidth') + 'px';
        break;
      case 'bottom-in':
        elem.style.top = calcAbsPosOf('bottom') - getStyleVal('borderBottomWidth') + 'px';
        elem.style.left = calcAbsPosOf('left') + getStyleVal('borderLeftWidth') + 'px';
        break;
      case 'right-in':
        elem.style.left = calcAbsPosOf('right') - getStyleVal('borderRightWidth') + 'px';
        elem.style.top = calcAbsPosOf('top') + getStyleVal('borderTopWidth') + 'px';
        break;
    }
  };

  var showNote = function showNote(anchor, position, html) {
    var note = document.createElement('div');
    note.className = 'note';
    note.innerHTML = html;
    document.body.appendChild(note);
    positionAt(anchor, position, note);
  };

  ['top-out', 'top-in', 'right-out', 'right-in', 'bottom-out', 'bottom-in', 'left-out', 'left-in'].map(function (dir) {
    showNote(scrolled, dir, 'Note ' + dir);
  });
}
task21();
//# sourceMappingURL=data:application/json;base64,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QUMsQ0FBQTtBQUMvQixjQUFVLENBQUMsTUFBTSxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQTtHQUNuQyxDQUFBOztBQUVELEdBQUMsU0FBUyxFQUFFLFFBQVEsRUFBRSxXQUFXLEVBQUUsVUFBVSxFQUFFLFlBQVksRUFBRSxXQUFXLEVBQUUsVUFBVSxFQUFFLFNBQVMsQ0FBQyxDQUMvRixHQUFHLENBQUMsVUFBQSxHQUFHLEVBQUk7QUFDVixZQUFRLENBQUMsUUFBUSxFQUFFLEdBQUcsWUFBVSxHQUFHLENBQUcsQ0FBQTtHQUN2QyxDQUFDLENBQUE7Q0FFSDtBQUNELE1BQU0sRUFBRSxDQUFBIiwiZmlsZSI6InBhcnQyL2RvbS8xMC5jb29yZGluYXRlcy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qQ29vcmRzIHJlbGF0aXZlIHRvIFZJU0lCTEUgV0lORE9XXG4gIHNpbWlsYXIgdG8gYHBvc2l0aW9uIGZpeGVkYFxuXG4gIGNsaWVudFgsIGNsaWVudFlcblxuICBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpXG4gIFxuICAgIHJldHVybiBvYmplY3QsIGNvbnRhaW5nIFxuICAgICAgdG9wXG4gICAgICBsZWZ0XG4gICAgICByaWdodFxuICAgICAgYm90dG9tIFxuICAgIGNvb3JkaW5hdGVzIG9mIGBlbGVtYFxuXG5cbiAgZG9jdW1lbnQuZWxlbUZyb21Qb2ludCh4LCB5KVxuXG4gICAgcmV0dXJuIGVsZW1lbnQgdGhhdCBob2xkaW5nIHgsIHkgcG9pbnRzXG4gICAgaG93IGFib3V0IHR3byBlbGVtZW50cz8gaWYgb3ZlcmxhcHBpbmdcbiovXG5cblxuXG4vKkNvb3JkcyByZWxhdGl2ZSB0byBXSE9MRSBQQUdFXG4gIHNpbWlsYXIgdG8gYHBvc2l0aW9uIGFic29sdXRlIGluIGJvZHlgXG5cbiAgYWRkIHBvc2l0aW9uIGluc2lkZSB3aW5kb3cgdG8gY3VycmVudCBzY3JvbGwgcG9zaXRpb25cblxuICBwYWdlWCA9IGNsaWVudFggKyBwYWdlWE9mZnNlc3QgKG9yIHNjcm9sbExlZnQpXG4gIHBhZ2VZID0gY2xpZW50WSArIHBhZ2VZT2Zmc2VzdCAob3Igc2Nyb2xsVG9wKVxuXG4qL1xuXG5cblxuXG4vKiBUYXNrIDFcbmZpbmQgXG4gIG91dGVyIHRvcC1sZWZ0IGNvcm5lclxuICBvdXRlciBib3R0b20tcmlnaHQgY29ybmVyXG4gIGlubmVyIHRvcC1sZWZ0IGNvcm5lclxuICBpbm5lciBib3R0b20tcmlnaHQgY29ybmVyXG4qL1xuXG5mdW5jdGlvbiB0YXNrMSAoKSB7XG4gIGxldCBmaWVsZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JvbGxlZCcpXG4gIGxldCBzdHJpbmdpZnkgPSAoeCwgeSkgPT4gYCR7eH0sICR7eX1gXG4gIGxldCBmaWVsZFJlY3QgPSBmaWVsZC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKVxuICBsZXQgZ2V0U3R5bGVWYWwgPSAoZWxlbSwgcHJvcCkgPT4gcGFyc2VJbnQoZ2V0Q29tcHV0ZWRTdHlsZShmaWVsZClbcHJvcF0pXG4gIFxuICBsZXQgdG9wTGVmdE91dGVyID0gICAgIHN0cmluZ2lmeShmaWVsZFJlY3QubGVmdCwgZmllbGRSZWN0LnRvcClcbiAgbGV0IGJvdHRvbVJpZ2h0T3V0ZXIgPSBzdHJpbmdpZnkoZmllbGRSZWN0LnJpZ2h0LCBmaWVsZFJlY3QuYm90dG9tKVxuICBsZXQgdG9wTGVmdElubmVyID0gICAgIHN0cmluZ2lmeShmaWVsZFJlY3QubGVmdCArIGZpZWxkLmNsaWVudExlZnRcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsZmllbGRSZWN0LnRvcCArIGZpZWxkLmNsaWVudFRvcClcbiAgbGV0IGJvdHRvbVJpZ2h0SW5uZXIgPSBzdHJpbmdpZnkoZmllbGRSZWN0LnJpZ2h0IC0gZ2V0U3R5bGVWYWwoZmllbGQsICdib3JkZXJSaWdodFdpZHRoJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAsZmllbGRSZWN0LmJvdHRvbSAtIGdldFN0eWxlVmFsKGZpZWxkLCAnYm9yZGVyQm90dG9tV2lkdGgnKSlcblxuICBjb25zb2xlLmxvZyh0b3BMZWZ0T3V0ZXIpIFxuICBjb25zb2xlLmxvZyh0b3BMZWZ0SW5uZXIpIFxuICBjb25zb2xlLmxvZyhib3R0b21SaWdodE91dGVyKSBcbiAgY29uc29sZS5sb2coYm90dG9tUmlnaHRJbm5lcikgXG59XG4vLyB0YXNrMSgpXG5cblxuXG5cbi8qVGFzayAyXG5cbtCh0L7Qt9C00LDQudGC0LUg0YTRg9C90LrRhtC40Y4gcG9zaXRpb25BdChhbmNob3IsIHBvc2l0aW9uLCBlbGVtKSxcbtC60L7RgtC+0YDQsNGPINC/0L7Qt9C40YbQuNC+0L3QuNGA0YPQtdGCINGN0LvQtdC80LXQvdGCIGVsZW0sINCyINC30LDQstC40YHQuNC80L7RgdGC0Lgg0L7RgiBwb3NpdGlvbixcbtGB0LLQtdGA0YXRgyAoXCJ0b3BcIiksINGB0L/RgNCw0LLQsCAoXCJyaWdodFwiKSDQuNC70Lgg0YHQvdC40LfRgyAoXCJib3R0b21cIikg0L7RgiDRjdC70LXQvNC10L3RgtCwIGFuY2hvci5cblxu0JjRgdC/0L7Qu9GM0LfRg9C50YLQtSDQtdGRLCDRh9GC0L7QsdGLINGB0LTQtdC70LDRgtGMINGE0YPQvdC60YbQuNGOIHNob3dOb3RlKGFuY2hvciwgcG9zaXRpb24sIGh0bWwpLFxu0LrQvtGC0L7RgNCw0Y8g0L/QvtC60LDQt9GL0LLQsNC10YIg0Y3Qu9C10LzQtdC90YIg0YEg0LrQu9Cw0YHRgdC+0Lwgbm90ZSDQuCDRgtC10LrRgdGC0L7QvCBodG1sXG7QvdCwINC/0L7Qt9C40YbQuNC4IHBvc2l0aW9uINGA0Y/QtNC+0Lwg0YEg0Y3Qu9C10LzQtdC90YLQvtC8IGFuY2hvci5cblxuXG5FbmxpZ2h0bWVudDogXG4gIHVzZSBUT1AgLyBMRUZUIHByb3BlcnRpZXMgd2hlbiBzZXQgdXAgcG9zaXRpb25pbmcgb2YgRklYRUQgZWxlbWVudFxuICAgIGFuZCB1c2UgdG9wL2xlZnQvcmlnaHQvYm90dG9tIG9mIGBhbmNob3JgIHRvIGdldCBjb29yZHNcblxuXG4qL1xuXG5mdW5jdGlvbiB0YXNrMiAoKSB7XG4gIGxldCBwb3NpdGlvbkF0ID0gKGFuY2hvciwgcG9zaXRpb24sIGVsZW0pID0+IHtcbiAgICBlbGVtLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJ1xuICAgIHN3aXRjaChwb3NpdGlvbil7XG4gICAgICBjYXNlICd0b3AnOlxuICAgICAgICBlbGVtLnN0eWxlLnRvcCA9IGFuY2hvci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgLSBlbGVtLm9mZnNldEhlaWdodCArICdweCdcbiAgICAgICAgZWxlbS5zdHlsZS5sZWZ0ID0gYW5jaG9yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgKyAncHgnXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdsZWZ0JzpcbiAgICAgICAgZWxlbS5zdHlsZS5sZWZ0ID0gYW5jaG9yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLmxlZnQgLSBlbGVtLm9mZnNldFdpZHRoICsgJ3B4J1xuICAgICAgICBlbGVtLnN0eWxlLnRvcCA9IGFuY2hvci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS50b3AgKyAncHgnXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdib3R0b20nOlxuICAgICAgICBlbGVtLnN0eWxlLnRvcCA9IGFuY2hvci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5ib3R0b20gKyAncHgnXG4gICAgICAgIGVsZW0uc3R5bGUubGVmdCA9IGFuY2hvci5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS5sZWZ0ICsgJ3B4J1xuICAgICAgICBicmVha1xuICAgICAgY2FzZSAncmlnaHQnOlxuICAgICAgICBlbGVtLnN0eWxlLmxlZnQgPSBhbmNob3IuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCkucmlnaHQgKyAncHgnXG4gICAgICAgIGVsZW0uc3R5bGUudG9wID0gYW5jaG9yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLnRvcCArICdweCdcbiAgICAgICAgYnJlYWtcbiAgICB9XG4gIH1cblxuICBsZXQgc2hvd05vdGUgPSAoYW5jaG9yLCBwb3NpdGlvbiwgaHRtbCkgPT4ge1xuICAgIGxldCBub3RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2JylcbiAgICBub3RlLmNsYXNzTmFtZSA9ICdub3RlJ1xuICAgIG5vdGUuaW5uZXJIVE1MID0gaHRtbFxuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobm90ZSlcbiAgICBwb3NpdGlvbkF0KGFuY2hvciwgcG9zaXRpb24sIG5vdGUpXG4gIH1cblxuICBbJ3RvcCcsICdyaWdodCcsICdib3R0b20nLCAnbGVmdCddLm1hcChkaXIgPT4ge1xuICAgIHNob3dOb3RlKHNjcm9sbGVkLCBkaXIsIGBIZWxsbyBub3RlIGF0ICR7ZGlyfSAhYClcbiAgfSlcblxufVxuLy8gdGFzazIoKSBcblxuXG5cbi8qVGFzayAzXG5cbtCd0LDQv9C40YjQuNGC0LUg0YTRg9C90LrRhtC40Y4gZ2V0RG9jdW1lbnRTY3JvbGwoKSwgXG7QutC+0YLQvtGA0LDRjyDQstC+0LfQstGA0LDRidCw0LXRgiDQvtCx0YrQtdC60YIg0YEg0LjQvdGE0L7RgNC80LDRhtC40LXQuSDQviDRgtC10LrRg9GJ0LXQuSDQv9GA0L7QutGA0YPRgtC60LUg0Lgg0L7QsdC70LDRgdGC0Lgg0LLQuNC00LjQvNC+0YHRgtC4LlxuXG7QodCy0L7QudGB0YLQstCwINC+0LHRitC10LrRgtCwLdGA0LXQt9GD0LvRjNGC0LDRgtCwOlxudG9wIOKAlCDQutC+0L7RgNC00LjQvdCw0YLQsCDQstC10YDRhdC90LXQuSDQs9GA0LDQvdC40YbRiyDQstC40LTQuNC80L7QuSDRh9Cw0YHRgtC4ICjQvtGC0L3QvtGB0LjRgtC10LvRjNC90L4g0LTQvtC60YPQvNC10L3RgtCwKS5cbmJvdHRvbSDigJQg0LrQvtC+0YDQtNC40L3QsNGC0LAg0L3QuNC20L3QtdC5INCz0YDQsNC90LjRhtGLINCy0LjQtNC40LzQvtC5INGH0LDRgdGC0LggKNC+0YLQvdC+0YHQuNGC0LXQu9GM0L3QviDQtNC+0LrRg9C80LXQvdGC0LApLlxuaGVpZ2h0IOKAlCDQv9C+0LvQvdCw0Y8g0LLRi9GB0L7RgtCwINC00L7QutGD0LzQtdC90YLQsCwg0LLQutC70Y7Rh9Cw0Y8g0L/RgNC+0LrRgNGD0YLQutGDLlxuXG4qL1xuXG5mdW5jdGlvbiB0YXNrMyAoKSB7XG4gIGxldCBnZXREb2N1bWVudFNjcm9sbCA9ICgpID0+IHtcbiAgICBsZXQgaHRtbCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudFxuICAgIGxldCBwYWdlSGVpZ2h0ID0gTWF0aC5tYXgoXG4gICAgICBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCwgaHRtbC5zY3JvbGxIZWlnaHQsXG4gICAgICBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCwgaHRtbC5vZmZzZXRIZWlnaHQsXG4gICAgICBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodCwgaHRtbC5jbGllbnRIZWlnaHRcbiAgICApO1xuZGVidWdnZXJcbiAgICByZXR1cm4ge1xuICAgICAgdG9wOiBwYWdlWU9mZnNldCxcbiAgICAgIGJvdHRvbTogcGFnZVlPZmZzZXQgKyBodG1sLmNsaWVudEhlaWdodCxcbiAgICAgIGhlaWdodDogaGVpZ2h0XG4gICAgfVxuICB9XG5cbiAgY29uc29sZS5sb2coZ2V0RG9jdW1lbnRTY3JvbGwoKSlcbn1cbi8vIHRhc2szKClcblxuXG5cblxuLyogVGFzazRcblxuTW9kaWZ5IHRhc2syIGZ1bmN0aW9uLCB0byBtYWtlIHRpcHMgc2Nyb2xsL3Jlc2l6ZSBhZ25vc3RpY1xuKi9cblxuZnVuY3Rpb24gdGFzazIxICgpIHtcbiAgbGV0IHBvc2l0aW9uQXQgPSAoYW5jaG9yLCBwb3NpdGlvbiwgZWxlbSkgPT4ge1xuICAgIGVsZW0uc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnXG4gICAgXG4gICAgbGV0IGNhbGNBYnNQb3NPZiA9ICh2YWwpID0+IHtcbiAgICAgIGxldCBvZmZzZXQgPSB2YWwgPT09ICdsZWZ0JyB8fCB2YWwgPT09ICdyaWdodCcgPyBwYWdlWE9mZnNldCA6IHBhZ2VZT2Zmc2V0XG4gICAgICByZXR1cm4gYW5jaG9yLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpW3ZhbF0gKyBvZmZzZXRcbiAgICB9XG4gICAgbGV0IGdldFN0eWxlVmFsID0gcHJvcCA9PiBwYXJzZUludChnZXRDb21wdXRlZFN0eWxlKGFuY2hvcilbcHJvcF0pXG5cbiAgICBzd2l0Y2gocG9zaXRpb24pe1xuICAgICAgY2FzZSAndG9wLW91dCc6XG4gICAgICAgIGVsZW0uc3R5bGUudG9wID0gY2FsY0Fic1Bvc09mKCd0b3AnKSAtIGVsZW0ub2Zmc2V0SGVpZ2h0ICsgJ3B4J1xuICAgICAgICBlbGVtLnN0eWxlLmxlZnQgPSBjYWxjQWJzUG9zT2YoJ2xlZnQnKSArICdweCdcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ2xlZnQtb3V0JzpcbiAgICAgICAgZWxlbS5zdHlsZS5sZWZ0ID0gY2FsY0Fic1Bvc09mKCdsZWZ0JykgLSBlbGVtLm9mZnNldFdpZHRoICsgJ3B4J1xuICAgICAgICBlbGVtLnN0eWxlLnRvcCA9IGNhbGNBYnNQb3NPZigndG9wJykgKyAncHgnXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdib3R0b20tb3V0JzpcbiAgICAgICAgZWxlbS5zdHlsZS50b3AgPSBjYWxjQWJzUG9zT2YoJ2JvdHRvbScpICsgJ3B4J1xuICAgICAgICBlbGVtLnN0eWxlLmxlZnQgPSBjYWxjQWJzUG9zT2YoJ2xlZnQnKSArICdweCdcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ3JpZ2h0LW91dCc6XG4gICAgICAgIGVsZW0uc3R5bGUubGVmdCA9IGNhbGNBYnNQb3NPZigncmlnaHQnKSArICdweCdcbiAgICAgICAgZWxlbS5zdHlsZS50b3AgPSBjYWxjQWJzUG9zT2YoJ3RvcCcpICsgJ3B4J1xuICAgICAgICBicmVha1xuICAgICAgY2FzZSAndG9wLWluJzpcbiAgICAgICAgZWxlbS5zdHlsZS50b3AgPSBjYWxjQWJzUG9zT2YoJ3RvcCcpICsgZ2V0U3R5bGVWYWwoJ2JvcmRlclRvcFdpZHRoJykgLSBlbGVtLm9mZnNldEhlaWdodCArICdweCdcbiAgICAgICAgZWxlbS5zdHlsZS5sZWZ0ID0gY2FsY0Fic1Bvc09mKCdsZWZ0JykgKyBnZXRTdHlsZVZhbCgnYm9yZGVyTGVmdFdpZHRoJykgKyAncHgnXG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICdsZWZ0LWluJzpcbiAgICAgICAgZWxlbS5zdHlsZS5sZWZ0ID0gY2FsY0Fic1Bvc09mKCdsZWZ0JykgKyBnZXRTdHlsZVZhbCgnYm9yZGVyTGVmdFdpZHRoJykgLSBlbGVtLm9mZnNldFdpZHRoICsgJ3B4J1xuICAgICAgICBlbGVtLnN0eWxlLnRvcCA9IGNhbGNBYnNQb3NPZigndG9wJykgKyBnZXRTdHlsZVZhbCgnYm9yZGVyVG9wV2lkdGgnKSArICdweCdcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ2JvdHRvbS1pbic6XG4gICAgICAgIGVsZW0uc3R5bGUudG9wID0gY2FsY0Fic1Bvc09mKCdib3R0b20nKSAtIGdldFN0eWxlVmFsKCdib3JkZXJCb3R0b21XaWR0aCcpICsgJ3B4J1xuICAgICAgICBlbGVtLnN0eWxlLmxlZnQgPSBjYWxjQWJzUG9zT2YoJ2xlZnQnKSArIGdldFN0eWxlVmFsKCdib3JkZXJMZWZ0V2lkdGgnKSArICdweCdcbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ3JpZ2h0LWluJzpcbiAgICAgICAgZWxlbS5zdHlsZS5sZWZ0ID0gY2FsY0Fic1Bvc09mKCdyaWdodCcpIC0gZ2V0U3R5bGVWYWwoJ2JvcmRlclJpZ2h0V2lkdGgnKSArICdweCdcbiAgICAgICAgZWxlbS5zdHlsZS50b3AgPSBjYWxjQWJzUG9zT2YoJ3RvcCcpICsgZ2V0U3R5bGVWYWwoJ2JvcmRlclRvcFdpZHRoJykgKyAncHgnXG4gICAgICAgIGJyZWFrXG4gICAgfVxuICB9XG5cbiAgbGV0IHNob3dOb3RlID0gKGFuY2hvciwgcG9zaXRpb24sIGh0bWwpID0+IHtcbiAgICBsZXQgbm90ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpXG4gICAgbm90ZS5jbGFzc05hbWUgPSAnbm90ZSdcbiAgICBub3RlLmlubmVySFRNTCA9IGh0bWxcbiAgICBkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKG5vdGUpXG4gICAgcG9zaXRpb25BdChhbmNob3IsIHBvc2l0aW9uLCBub3RlKVxuICB9XG5cbiAgWyd0b3Atb3V0JywgJ3RvcC1pbicsICdyaWdodC1vdXQnLCAncmlnaHQtaW4nLCAnYm90dG9tLW91dCcsICdib3R0b20taW4nLCAnbGVmdC1vdXQnLCAnbGVmdC1pbiddXG4gIC5tYXAoZGlyID0+IHtcbiAgICBzaG93Tm90ZShzY3JvbGxlZCwgZGlyLCBgTm90ZSAke2Rpcn1gKVxuICB9KVxuXG59XG50YXNrMjEoKSBcblxuXG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
