'use strict';

/*
  keydown / keyup: fired when key is down / up

    allow to get `event.keyCode` - unified code, represented for each key
      - layout agnostic
      - lettercase agnostic
      - 'Z'.keyCode === 'Z'.charPointAt(0)  (works for [a-zA-Z0-9])
  


  keypress: fired after keydown, if key generate a `symbol` (all keys except special, like F1, Ctrl ...)

    allow to get `event.charCode` - code for each pressed char
    crossbrowser function to get charcode, presented in `example1`


  
  You can prevent keyboard event to cancel user input



  all keyboard events support `modifier keys`: altKey / ctrlKey / shiftKey / metaKey
*/

function example1() {

  /*Crossbroser function to get correct key symbol*/

  // event.type должен быть keypress
  function getChar(event) {
    if (event.which == null) {
      // IE
      if (event.keyCode < 32) return null; // спец. символ
      return String.fromCharCode(event.keyCode);
    }

    if (event.which != 0 && event.charCode != 0) {
      // все кроме IE
      if (event.which < 32) return null; // спец. символ
      return String.fromCharCode(event.which); // остальные
    }

    return null; // спец. символ
  }
}
// example1()

/*Task 1:
При помощи событий клавиатуры сделайте так, чтобы в поле можно было вводить только цифры. 
*/

function task1() {

  var filterNonDigits = function filterNonDigits(e) {
    var key = e.keyCode;

    var isInside = function isInside(x, y) {
      return key >= x && key <= y;
    };

    var isLetter = function isLetter() {
      return isInside(65, 90);
    };
    var isAriphmetics = function isAriphmetics() {
      return isInside(186, 192);
    };
    var isPunctuation1 = function isPunctuation1() {
      return isInside(186, 192);
    };
    var isPunctuation2 = function isPunctuation2() {
      return isInside(219, 222);
    };
    var isSpecialMode = function isSpecialMode() {
      return e.metaKey || e.shiftKey || e.altKey || e.ctrlKey;
    };

    if (!isSpecialMode() && isLetter() || isAriphmetics() || isPunctuation1() || isPunctuation2()) {
      e.preventDefault();
    }
  };

  numbersOnly.addEventListener('keydown', filterNonDigits);
}
// task1()

/*More correct desicion with keypress*/

function task1correct() {
  function getChar(event) {
    if (event.which == null) {
      // IE
      if (event.keyCode < 32) return null; // спец. символ
      return String.fromCharCode(event.keyCode);
    }

    if (event.which != 0 && event.charCode != 0) {
      // все кроме IE
      if (event.which < 32) return null; // спец. символ
      return String.fromCharCode(event.which); // остальные
    }

    return null; // спец. символ
  }

  var isSpecialMode = function isSpecialMode(e) {
    return e.metaKey || e.shiftKey || e.altKey || e.ctrlKey;
  };
  var isOutside = function isOutside(char, x, y) {
    return char < x || char > y;
  };

  var filterNonDigits = function filterNonDigits(e) {
    var char = getChar(e);
    if (isSpecialMode(e) || isOutside(char, '0', '9')) {
      e.preventDefault();
    };
  };

  numbersOnly.addEventListener('keypress', filterNonDigits);
}
task1correct();

/*Task 2
Создайте функцию runOnKeys(func, code1, code2, ... code_n), 
которая запускает func при одновременном нажатии клавиш со скан-кодами code1, code2, …, code_n.

Например, код ниже выведет alert при одновременном нажатии клавиш "Q" и "W" (в любом регистре, в любой раскладке)

  algo: 
    args -> ['c']

*/

function task2() {

  var runOnKeys = function runOnKeys(func) {
    for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
      args[_key - 1] = arguments[_key];
    }

    var pressedKeys = args.reduce(function (a, i) {
      a[i] = false;
      return a;
    }, {});

    var isPressedAll = function isPressedAll(keys) {
      for (var key in keys) {
        if (keys[key] === false) return false;
      }
      return true;
    };

    var setCurrentKeyStatus = function setCurrentKeyStatus(keys, status, e) {
      if (keys[e.keyCode] !== undefined) {
        keys[e.keyCode] = status;
      }
    };

    var handleDown = function handleDown(e) {
      setCurrentKeyStatus(pressedKeys, true, e);

      if (isPressedAll(pressedKeys)) {
        func.apply(null);
      };
    };

    document.addEventListener('keydown', handleDown);
    document.addEventListener('keyup', setCurrentKeyStatus.bind(null, pressedKeys, false));
  };

  runOnKeys(function () {
    return console.log('BT!');
  }, "B".charCodeAt(0), "T".charCodeAt(0));
  runOnKeys(function () {
    return console.log('YN!');
  }, "Y".charCodeAt(0), "N".charCodeAt(0));
}
task2();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIjA5LmtleWJvYXJkX2V2ZW50cy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXlCQSxTQUFTLFFBQVEsR0FBSTs7Ozs7QUFLbkIsV0FBUyxPQUFPLENBQUMsS0FBSyxFQUFFO0FBQ3RCLFFBQUksS0FBSyxDQUFDLEtBQUssSUFBSSxJQUFJLEVBQUU7O0FBQ3ZCLFVBQUksS0FBSyxDQUFDLE9BQU8sR0FBRyxFQUFFLEVBQUUsT0FBTyxJQUFJLENBQUM7QUFBQSxBQUNwQyxhQUFPLE1BQU0sQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0tBQzFDOztBQUVELFFBQUksS0FBSyxDQUFDLEtBQUssSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLFFBQVEsSUFBSSxDQUFDLEVBQUU7O0FBQzNDLFVBQUksS0FBSyxDQUFDLEtBQUssR0FBRyxFQUFFLEVBQUUsT0FBTyxJQUFJLENBQUM7QUFBQSxBQUNsQyxhQUFPLE1BQU0sQ0FBQyxZQUFZLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQztBQUFDLEtBQ3pDOztBQUVELFdBQU8sSUFBSTtBQUFDLEdBQ2I7Q0FFRjs7Ozs7OztBQUFBLEFBVUQsU0FBUyxLQUFLLEdBQUk7O0FBRWhCLE1BQUksZUFBZSxHQUFHLFNBQWxCLGVBQWUsQ0FBSSxDQUFDLEVBQUs7QUFDM0IsUUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQTs7QUFFbkIsUUFBSSxRQUFRLEdBQUcsU0FBWCxRQUFRLENBQUksQ0FBQyxFQUFDLENBQUM7YUFBSyxHQUFHLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0tBQUEsQ0FBQTs7QUFFNUMsUUFBSSxRQUFRLEdBQVMsU0FBakIsUUFBUTthQUFlLFFBQVEsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDO0tBQUEsQ0FBQTtBQUMzQyxRQUFJLGFBQWEsR0FBSSxTQUFqQixhQUFhO2FBQVUsUUFBUSxDQUFDLEdBQUcsRUFB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QyxDQUFDLEVBQUUsR0FBRyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFBO0NBRTFFO0FBQ0QsS0FBSyxFQUFFLENBQUEiLCJmaWxlIjoicGFydDIvZXZlbnRzLzA5LmtleWJvYXJkX2V2ZW50cy5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gIGtleWRvd24gLyBrZXl1cDogZmlyZWQgd2hlbiBrZXkgaXMgZG93biAvIHVwXG5cbiAgICBhbGxvdyB0byBnZXQgYGV2ZW50LmtleUNvZGVgIC0gdW5pZmllZCBjb2RlLCByZXByZXNlbnRlZCBmb3IgZWFjaCBrZXlcbiAgICAgIC0gbGF5b3V0IGFnbm9zdGljXG4gICAgICAtIGxldHRlcmNhc2UgYWdub3N0aWNcbiAgICAgIC0gJ1onLmtleUNvZGUgPT09ICdaJy5jaGFyUG9pbnRBdCgwKSAgKHdvcmtzIGZvciBbYS16QS1aMC05XSlcbiAgXG5cblxuICBrZXlwcmVzczogZmlyZWQgYWZ0ZXIga2V5ZG93biwgaWYga2V5IGdlbmVyYXRlIGEgYHN5bWJvbGAgKGFsbCBrZXlzIGV4Y2VwdCBzcGVjaWFsLCBsaWtlIEYxLCBDdHJsIC4uLilcblxuICAgIGFsbG93IHRvIGdldCBgZXZlbnQuY2hhckNvZGVgIC0gY29kZSBmb3IgZWFjaCBwcmVzc2VkIGNoYXJcbiAgICBjcm9zc2Jyb3dzZXIgZnVuY3Rpb24gdG8gZ2V0IGNoYXJjb2RlLCBwcmVzZW50ZWQgaW4gYGV4YW1wbGUxYFxuXG5cbiAgXG4gIFlvdSBjYW4gcHJldmVudCBrZXlib2FyZCBldmVudCB0byBjYW5jZWwgdXNlciBpbnB1dFxuXG5cblxuICBhbGwga2V5Ym9hcmQgZXZlbnRzIHN1cHBvcnQgYG1vZGlmaWVyIGtleXNgOiBhbHRLZXkgLyBjdHJsS2V5IC8gc2hpZnRLZXkgLyBtZXRhS2V5XG4qL1xuXG5cbmZ1bmN0aW9uIGV4YW1wbGUxICgpIHtcbiAgXG4gIC8qQ3Jvc3Nicm9zZXIgZnVuY3Rpb24gdG8gZ2V0IGNvcnJlY3Qga2V5IHN5bWJvbCovXG5cbiAgLy8gZXZlbnQudHlwZSDQtNC+0LvQttC10L0g0LHRi9GC0Ywga2V5cHJlc3NcbiAgZnVuY3Rpb24gZ2V0Q2hhcihldmVudCkge1xuICAgIGlmIChldmVudC53aGljaCA9PSBudWxsKSB7IC8vIElFXG4gICAgICBpZiAoZXZlbnQua2V5Q29kZSA8IDMyKSByZXR1cm4gbnVsbDsgLy8g0YHQv9C10YYuINGB0LjQvNCy0L7Qu1xuICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoZXZlbnQua2V5Q29kZSlcbiAgICB9XG5cbiAgICBpZiAoZXZlbnQud2hpY2ggIT0gMCAmJiBldmVudC5jaGFyQ29kZSAhPSAwKSB7IC8vINCy0YHQtSDQutGA0L7QvNC1IElFXG4gICAgICBpZiAoZXZlbnQud2hpY2ggPCAzMikgcmV0dXJuIG51bGw7IC8vINGB0L/QtdGGLiDRgdC40LzQstC+0LtcbiAgICAgIHJldHVybiBTdHJpbmcuZnJvbUNoYXJDb2RlKGV2ZW50LndoaWNoKTsgLy8g0L7RgdGC0LDQu9GM0L3Ri9C1XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7IC8vINGB0L/QtdGGLiDRgdC40LzQstC+0LtcbiAgfVxuXG59XG4vLyBleGFtcGxlMSgpXG5cblxuXG5cbi8qVGFzayAxOlxu0J/RgNC4INC/0L7QvNC+0YnQuCDRgdC+0LHRi9GC0LjQuSDQutC70LDQstC40LDRgtGD0YDRiyDRgdC00LXQu9Cw0LnRgtC1INGC0LDQuiwg0YfRgtC+0LHRiyDQsiDQv9C+0LvQtSDQvNC+0LbQvdC+INCx0YvQu9C+INCy0LLQvtC00LjRgtGMINGC0L7Qu9GM0LrQviDRhtC40YTRgNGLLiBcbiovXG5cbmZ1bmN0aW9uIHRhc2sxICgpIHtcbiAgXG4gIGxldCBmaWx0ZXJOb25EaWdpdHMgPSAoZSkgPT4ge1xuICAgIGxldCBrZXkgPSBlLmtleUNvZGVcblxuICAgIGxldCBpc0luc2lkZSA9ICh4LHkpID0+IGtleSA+PSB4ICYmIGtleSA8PSB5XG5cbiAgICBsZXQgaXNMZXR0ZXIgICAgICAgPSAoKSA9PiBpc0luc2lkZSg2NSwgOTApXG4gICAgbGV0IGlzQXJpcGhtZXRpY3MgID0gKCkgPT4gaXNJbnNpZGUoMTg2LCAxOTIpXG4gICAgbGV0IGlzUHVuY3R1YXRpb24xID0gKCkgPT4gaXNJbnNpZGUoMTg2LCAxOTIpXG4gICAgbGV0IGlzUHVuY3R1YXRpb24yID0gKCkgPT4gaXNJbnNpZGUoMjE5LCAyMjIpXG4gICAgbGV0IGlzU3BlY2lhbE1vZGUgPSAoKSA9PiBlLm1ldGFLZXkgfHwgZS5zaGlmdEtleSB8fCBlLmFsdEtleSB8fCBlLmN0cmxLZXlcblxuXG4gICAgaWYgKCFpc1NwZWNpYWxNb2RlKCkgJiYgaXNMZXR0ZXIoKSB8fCBpc0FyaXBobWV0aWNzKCkgfHwgaXNQdW5jdHVhdGlvbjEoKSB8fCBpc1B1bmN0dWF0aW9uMigpKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KClcbiAgICB9XG4gIH1cblxuICBudW1iZXJzT25seS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgZmlsdGVyTm9uRGlnaXRzKVxufVxuLy8gdGFzazEoKVxuXG5cbi8qTW9yZSBjb3JyZWN0IGRlc2ljaW9uIHdpdGgga2V5cHJlc3MqL1xuXG5mdW5jdGlvbiB0YXNrMWNvcnJlY3QgKCkge1xuICBmdW5jdGlvbiBnZXRDaGFyKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LndoaWNoID09IG51bGwpIHsgLy8gSUVcbiAgICAgIGlmIChldmVudC5rZXlDb2RlIDwgMzIpIHJldHVybiBudWxsOyAvLyDRgdC/0LXRhi4g0YHQuNC80LLQvtC7XG4gICAgICByZXR1cm4gU3RyaW5nLmZyb21DaGFyQ29kZShldmVudC5rZXlDb2RlKVxuICAgIH1cblxuICAgIGlmIChldmVudC53aGljaCAhPSAwICYmIGV2ZW50LmNoYXJDb2RlICE9IDApIHsgLy8g0LLRgdC1INC60YDQvtC80LUgSUVcbiAgICAgIGlmIChldmVudC53aGljaCA8IDMyKSByZXR1cm4gbnVsbDsgLy8g0YHQv9C10YYuINGB0LjQvNCy0L7Qu1xuICAgICAgcmV0dXJuIFN0cmluZy5mcm9tQ2hhckNvZGUoZXZlbnQud2hpY2gpOyAvLyDQvtGB0YLQsNC70YzQvdGL0LVcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDsgLy8g0YHQv9C10YYuINGB0LjQvNCy0L7Qu1xuICB9XG5cbiAgbGV0IGlzU3BlY2lhbE1vZGUgPSAoZSkgPT4gZS5tZXRhS2V5IHx8IGUuc2hpZnRLZXkgfHwgZS5hbHRLZXkgfHwgZS5jdHJsS2V5XG4gIGxldCBpc091dHNpZGUgPSAoY2hhciwgeCwgeSkgPT4gY2hhciA8IHggfHwgY2hhciA+IHlcblxuXG4gIGxldCBmaWx0ZXJOb25EaWdpdHMgPSBlID0+IHtcbiAgICBsZXQgY2hhciA9IGdldENoYXIoZSlcbiAgICBpZiAoaXNTcGVjaWFsTW9kZShlKSB8fCBpc091dHNpZGUoY2hhciwgJzAnLCc5JykpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgIH07XG4gIH1cblxuICBudW1iZXJzT25seS5hZGRFdmVudExpc3RlbmVyKCdrZXlwcmVzcycsIGZpbHRlck5vbkRpZ2l0cylcbn1cbnRhc2sxY29ycmVjdCgpXG5cblxuXG4vKlRhc2sgMlxu0KHQvtC30LTQsNC50YLQtSDRhNGD0L3QutGG0LjRjiBydW5PbktleXMoZnVuYywgY29kZTEsIGNvZGUyLCAuLi4gY29kZV9uKSwgXG7QutC+0YLQvtGA0LDRjyDQt9Cw0L/Rg9GB0LrQsNC10YIgZnVuYyDQv9GA0Lgg0L7QtNC90L7QstGA0LXQvNC10L3QvdC+0Lwg0L3QsNC20LDRgtC40Lgg0LrQu9Cw0LLQuNGIINGB0L4g0YHQutCw0L0t0LrQvtC00LDQvNC4IGNvZGUxLCBjb2RlMiwg4oCmLCBjb2RlX24uXG5cbtCd0LDQv9GA0LjQvNC10YAsINC60L7QtCDQvdC40LbQtSDQstGL0LLQtdC00LXRgiBhbGVydCDQv9GA0Lgg0L7QtNC90L7QstGA0LXQvNC10L3QvdC+0Lwg0L3QsNC20LDRgtC40Lgg0LrQu9Cw0LLQuNGIIFwiUVwiINC4IFwiV1wiICjQsiDQu9GO0LHQvtC8INGA0LXQs9C40YHRgtGA0LUsINCyINC70Y7QsdC+0Lkg0YDQsNGB0LrQu9Cw0LTQutC1KVxuXG4gIGFsZ286IFxuICAgIGFyZ3MgLT4gWydjJ11cblxuKi9cblxuZnVuY3Rpb24gdGFzazIgKCkge1xuXG4gIGNvbnN0IHJ1bk9uS2V5cyA9IChmdW5jLCAuLi5hcmdzKSA9PiB7XG5cbiAgICBsZXQgcHJlc3NlZEtleXMgPSBhcmdzLnJlZHVjZSgoYSxpKSA9PiB7XG4gICAgICBhW2ldID0gZmFsc2VcbiAgICAgIHJldHVybiBhXG4gICAgfSwge30pXG5cbiAgICBsZXQgaXNQcmVzc2VkQWxsID0gKGtleXMpID0+IHtcbiAgICAgIGZvcihsZXQga2V5IGluIGtleXMpe1xuICAgICAgICBpZiAoa2V5c1trZXldID09PSBmYWxzZSkgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIGxldCBzZXRDdXJyZW50S2V5U3RhdHVzID0gKGtleXMsIHN0YXR1cywgZSkgPT4ge1xuICAgICAgaWYgKGtleXNbZS5rZXlDb2RlXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGtleXNbZS5rZXlDb2RlXSA9IHN0YXR1c1xuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBoYW5kbGVEb3duID0gZSA9PiB7XG4gICAgICBzZXRDdXJyZW50S2V5U3RhdHVzKHByZXNzZWRLZXlzLCB0cnVlLCBlKVxuXG4gICAgICBpZiAoaXNQcmVzc2VkQWxsKHByZXNzZWRLZXlzKSkge1xuICAgICAgICBmdW5jLmFwcGx5KG51bGwpICBcbiAgICAgIH07XG4gICAgfVxuXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGhhbmRsZURvd24pXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBzZXRDdXJyZW50S2V5U3RhdHVzLmJpbmQobnVsbCwgcHJlc3NlZEtleXMsIGZhbHNlKSlcbiAgfVxuXG4gIHJ1bk9uS2V5cyggKCkgPT5jb25zb2xlLmxvZygnQlQhJyksIFwiQlwiLmNoYXJDb2RlQXQoMCksIFwiVFwiLmNoYXJDb2RlQXQoMCkpXG4gIHJ1bk9uS2V5cyggKCkgPT5jb25zb2xlLmxvZygnWU4hJyksIFwiWVwiLmNoYXJDb2RlQXQoMCksIFwiTlwiLmNoYXJDb2RlQXQoMCkpXG5cbn1cbnRhc2syKClcbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
